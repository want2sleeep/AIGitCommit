# Changelog

All notable changes to the "AI Git Commit Generator" extension will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [0.0.1] - 2024-11-14

### 🎉 Initial Release

首个版本发布，实现了基于 AI 的 Git 提交信息自动生成功能。

### ✨ Features

#### 核心功能

- **AI 驱动的提交信息生成**: 使用大语言模型智能分析代码变更并生成专业的提交信息
- **OpenAI 兼容 API 支持**: 支持所有 OpenAI 兼容的 LLM 服务（OpenAI、Azure OpenAI、Ollama、LocalAI 等）
- **约定式提交格式**: 自动生成符合 Conventional Commits 规范的提交信息
- **多语言支持**: 支持中文和英文提交信息生成

#### 配置管理 (需求 1)

- ✅ **API 配置界面**: 提供完整的配置界面用于设置 API 端点、密钥和模型名称 (需求 1.1, 1.2, 1.3)
- ✅ **安全存储**: API 密钥安全存储在 VSCode SecretStorage 中 (需求 1.4)
- ✅ **配置验证**: 自动验证配置的有效性和完整性 (需求 1.5)
- ✅ **配置向导**: 首次使用时自动引导用户完成配置
- ✅ **配置迁移**: 自动将旧版本的明文 API 密钥迁移到安全存储

#### Git 集成 (需求 2)

- ✅ **Git 仓库检测**: 自动检测当前工作区是否为 Git 仓库 (需求 2.1)
- ✅ **暂存变更获取**: 获取暂存区的文件变更列表和详细差异 (需求 2.2, 2.3)
- ✅ **智能过滤**: 自动过滤二进制文件和大文件的差异内容 (需求 2.4)
- ✅ **变更验证**: 在无暂存变更时提示用户先暂存变更 (需求 2.5)
- ✅ **Diff 优化**: 智能截断和格式化 diff 内容，避免超出 LLM 上下文限制

#### LLM 服务调用 (需求 3)

- ✅ **提示词构建**: 将 Git 差异内容格式化为 LLM 可理解的提示词 (需求 3.1)
- ✅ **API 调用**: 使用配置的 API 信息调用 OpenAI 兼容的 LLM 服务 (需求 3.2)
- ✅ **加载状态**: 在调用 LLM 时显示进度指示器 (需求 3.3)
- ✅ **响应解析**: 解析并提取 LLM 生成的提交信息 (需求 3.4)
- ✅ **错误处理**: 完善的 API 错误处理和重试机制 (需求 3.5)
- ✅ **请求超时**: 30 秒超时机制，防止长时间等待
- ✅ **自动重试**: 失败时自动重试最多 3 次，使用指数退避策略
- ✅ **取消支持**: 支持取消正在进行的 API 请求

#### 用户界面 (需求 4)

- ✅ **提交信息预览**: 在输入框中显示生成的提交信息 (需求 4.1)
- ✅ **编辑功能**: 允许用户编辑生成的提交信息 (需求 4.2)
- ✅ **操作按钮**: 提供接受、重新生成和取消按钮 (需求 4.3, 4.4, 4.5)
- ✅ **进度反馈**: 在状态栏和进度条中显示操作进度
- ✅ **友好提示**: 清晰的用户提示和操作引导

#### 命令和快捷方式 (需求 5)

- ✅ **命令面板集成**: 在 VSCode 命令面板中注册命令 (需求 5.1)
- ✅ **SCM 视图集成**: 在源代码管理视图中提供快捷按钮 (需求 5.2)
- ✅ **键盘快捷键**: 支持 `Ctrl+Shift+G C` (Mac: `Cmd+Shift+G C`) 快捷键 (需求 5.3)
- ✅ **完整流程**: 触发命令时执行完整的生成流程 (需求 5.4)
- ✅ **状态栏显示**: 在状态栏显示操作进度 (需求 5.5)

#### 错误处理 (需求 6)

- ✅ **配置错误处理**: 配置缺失时提示用户完成配置 (需求 6.1)
- ✅ **网络错误处理**: 网络连接失败时显示清晰的错误信息 (需求 6.2)
- ✅ **API 错误处理**: API 返回错误时显示具体的错误原因 (需求 6.3)
- ✅ **Git 错误处理**: Git 命令执行失败时显示相关错误信息 (需求 6.4)
- ✅ **详细日志**: 记录详细的错误日志用于调试 (需求 6.5)
- ✅ **错误分类**: 区分不同类型的错误（401, 429, 500 等）
- ✅ **操作建议**: 为每种错误类型提供具体的解决建议
- ✅ **快捷操作**: 提供"打开设置"、"重试"、"查看日志"等快捷按钮

#### 提交信息质量 (需求 7)

- ✅ **简洁标题**: 生成简洁明了的提交标题 (需求 7.1)
- ✅ **详细描述**: 在必要时提供详细的提交描述 (需求 7.2)
- ✅ **约定式格式**: 使用约定式提交格式（Conventional Commits） (需求 7.3)
- ✅ **语言配置**: 支持用户配置的语言（中文/英文） (需求 7.4)
- ✅ **长度限制**: 限制提交标题长度在 50-72 字符范围内 (需求 7.5)
- ✅ **格式验证**: 验证生成的提交信息格式和长度
- ✅ **后处理优化**: 对生成的提交信息进行后处理和优化

### 🔧 Technical Implementation

#### 架构设计

- **模块化架构**: 清晰的模块划分（ConfigurationManager、GitService、LLMService、UIManager、ErrorHandler）
- **TypeScript**: 使用 TypeScript 开发，提供完整的类型安全
- **异步处理**: 所有 IO 操作使用异步处理，不阻塞 VSCode 主线程
- **错误边界**: 完善的错误处理和恢复机制

#### 性能优化

- **Diff 内容限制**: 单个文件 diff 限制 5000 行，总 diff 限制 20000 字符
- **智能过滤**: 过滤不相关的文件（如 package-lock.json）
- **请求优化**: 合理的 max_tokens 限制（500-1000）
- **资源管理**: 内存占用 <50MB，响应时间 <100ms

#### 安全性

- **密钥安全**: API 密钥使用 VSCode SecretStorage 安全存储
- **日志安全**: 不在日志中记录敏感信息
- **输入验证**: 验证所有用户输入，防止注入攻击

### 📚 Documentation

- ✅ **README.md**: 完整的功能介绍、安装指南和使用说明
- ✅ **配置示例**: 提供多种服务的配置示例（OpenAI、Azure OpenAI、Ollama 等）
- ✅ **使用示例**: 提供实际的代码变更和生成的提交信息示例
- ✅ **FAQ**: 常见问题解答
- ✅ **提示词模板**: 自定义提示词和优化技巧
- ✅ **约定式提交指南**: 完整的 Conventional Commits 规范说明

### 🧪 Testing

- ✅ **单元测试**: 为所有核心模块编写单元测试
  - ConfigurationManager 测试
  - GitService 测试
  - LLMService 测试
  - ErrorHandler 测试
- ✅ **集成测试**: 测试完整的提交信息生成流程
- ✅ **错误场景测试**: 测试各种错误场景的处理
- ✅ **测试覆盖率**: 达到 >80% 的代码覆盖率

### 🎯 Supported Services

支持以下 OpenAI 兼容服务：

- **OpenAI**: 官方 OpenAI API
- **Azure OpenAI**: Azure 托管的 OpenAI 服务
- **Ollama**: 本地运行的开源模型
- **LocalAI**: 本地 OpenAI 兼容服务
- **LM Studio**: 桌面 LLM 应用
- **Text Generation WebUI**: Oobabooga 的 WebUI
- **vLLM**: 高性能 LLM 推理引擎
- **其他**: 任何实现 OpenAI API 格式的服务

### 📦 Package Information

- **Extension ID**: `ai-git-commit`
- **Display Name**: AI Git Commit
- **Version**: 0.0.1
- **Publisher**: SleepSheep
- **VSCode Engine**: ^1.85.0
- **Categories**: SCM Providers, Other
- **License**: MIT

### 🔗 Dependencies

- **axios**: ^1.6.2 - HTTP 客户端，用于 API 调用
- **TypeScript**: ^5.3.3 - 开发语言
- **Jest**: ^30.2.0 - 测试框架

---

## 🐛 Known Issues

### 当前已知问题

1. **大型变更集**: 当变更文件过多或 diff 内容过大时，可能会超出 LLM 的上下文限制
   - **临时解决方案**: 分批暂存和提交变更

2. **特殊字符处理**: 某些特殊字符在 diff 中可能导致格式问题
   - **临时解决方案**: 手动编辑生成的提交信息

3. **网络代理**: 在某些网络代理环境下可能需要额外配置
   - **临时解决方案**: 配置 VSCode 的代理设置

4. **模型响应质量**: 不同模型生成的提交信息质量可能有差异
   - **建议**: 使用 GPT-3.5-turbo 或更高版本的模型

### 限制

- 仅支持 Git 版本控制系统
- 需要网络连接（除非使用本地模型）
- 依赖 LLM 服务的可用性和响应速度

---

## 🚀 Future Plans

### 计划中的功能

#### v0.1.0 - 增强功能

- [ ] **自定义提示词模板**: 允许用户完全自定义提示词
- [ ] **提交历史学习**: 分析项目历史提交，学习项目特定的提交风格
- [ ] **批量提交**: 支持为多个变更集生成提交信息
- [ ] **智能拆分**: 自动识别并建议拆分大型变更
- [ ] **提交信息模板**: 提供多种预设的提交信息模板

#### v0.2.0 - 集成增强

- [ ] **Issue 跟踪集成**: 自动关联 Issue 编号（GitHub、GitLab、Jira 等）
- [ ] **团队规范**: 支持团队共享的提交规范配置
- [ ] **代码审查集成**: 在代码审查时生成变更摘要
- [ ] **CI/CD 集成**: 支持在 CI/CD 流程中使用

#### v0.3.0 - 高级功能

- [ ] **多仓库支持**: 同时管理多个 Git 仓库
- [ ] **变更分类**: 自动将变更分类为不同的提交
- [ ] **提交信息评分**: 评估提交信息质量并提供改进建议
- [ ] **统计和分析**: 提供提交信息质量统计和分析

#### v0.4.0 - 性能和体验

- [ ] **流式响应**: 支持 LLM 流式响应，实时显示生成过程
- [ ] **离线模式**: 支持完全离线使用（需要本地模型）
- [ ] **缓存机制**: 缓存最近的生成结果，加快响应速度
- [ ] **增量更新**: 支持增量更新提交信息

#### 长期规划

- [ ] **多语言扩展**: 支持更多语言（日语、韩语、法语等）
- [ ] **插件生态**: 提供 API 供其他插件调用
- [ ] **Web 版本**: 提供 Web 版本的提交信息生成器
- [ ] **移动端支持**: 支持移动端 Git 客户端集成
- [ ] **AI 模型微调**: 提供针对特定项目的模型微调功能

### 改进计划

- **性能优化**: 进一步优化 diff 处理和 API 调用性能
- **错误处理**: 增强错误处理和恢复机制
- **用户体验**: 改进 UI/UX，提供更流畅的交互体验
- **文档完善**: 提供更详细的文档和教程
- **测试覆盖**: 提高测试覆盖率到 >90%

---

## 📝 Notes

### 开发说明

- 本项目遵循 [Conventional Commits](https://www.conventionalcommits.org/) 规范
- 使用 [Semantic Versioning](https://semver.org/) 进行版本管理
- 欢迎提交 Issue 和 Pull Request

### 致谢

感谢所有为本项目做出贡献的开发者和用户！

---

## 🔗 Links

- **GitHub Repository**: [待添加]
- **VSCode Marketplace**: [待发布]
- **Documentation**: [README.md](./README.md)
- **Issue Tracker**: [待添加]
- **Changelog**: [CHANGELOG.md](./CHANGELOG.md)

---

**[0.0.1]**: 2024-11-14
